
Some useful commands.

# initialize a template host
ec2-run-instances ami-f3d1bb9a -k gyepi@ec2 -t t1.micro  -f ec2-initialize-production

# create an image based on the template host
ec2-create-template-image $INSTANCEID

# run a bunch of spot instances (15 by default)
./run-spot-instances $IMAGEID $KEY

# make a list of cluster hosts
aws ec2 describe-instances | jq -M -r '.Reservations[].Instances[].PublicDnsName') > cluster

export CLUSTER=$PWD/cluster

# list processes on each node
dsh -l ubuntu -g web 'ps ax' | tee /tmp/ps.log


# get the last 10 log entries on each node
dsh -l ubuntu 'tail /var/log/syslog' | tee /tmp/syslog.log


# tail instance logs - can't use dsh here
cat cluster | parallel -u ssh {} tail -f /var/log/syslog
